{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _reactDom = require('react-dom');\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _domScrollIntoView = require('dom-scroll-into-view');\n\nvar _domScrollIntoView2 = _interopRequireDefault(_domScrollIntoView);\n\nvar _has = require('lodash/has');\n\nvar _has2 = _interopRequireDefault(_has);\n\nvar _createBaseForm = require('./createBaseForm');\n\nvar _createBaseForm2 = _interopRequireDefault(_createBaseForm);\n\nvar _createForm = require('./createForm');\n\nvar _utils = require('./utils');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    'default': obj\n  };\n}\n\nfunction computedStyle(el, prop) {\n  var getComputedStyle = window.getComputedStyle;\n  var style = // If we have getComputedStyle\n  getComputedStyle ? // Query it\n  // TODO: From CSS-Query notes, we might need (node, null) for FF\n  getComputedStyle(el) : // Otherwise, we are in IE and use currentStyle\n  el.currentStyle;\n\n  if (style) {\n    return style[// Switch to camelCase for CSSOM\n    // DEV: Grabbed from jQuery\n    // https://github.com/jquery/jquery/blob/1.9-stable/src/css.js#L191-L194\n    // https://github.com/jquery/jquery/blob/1.9-stable/src/core.js#L593-L597\n    prop.replace(/-(\\w)/gi, function (word, letter) {\n      return letter.toUpperCase();\n    })];\n  }\n\n  return undefined;\n}\n\nfunction getScrollableContainer(n) {\n  var node = n;\n  var nodeName = void 0;\n  /* eslint no-cond-assign:0 */\n\n  while ((nodeName = node.nodeName.toLowerCase()) !== 'body') {\n    var overflowY = computedStyle(node, 'overflowY'); // https://stackoverflow.com/a/36900407/3040605\n\n    if (node !== n && (overflowY === 'auto' || overflowY === 'scroll') && node.scrollHeight > node.clientHeight) {\n      return node;\n    }\n\n    node = node.parentNode;\n  }\n\n  return nodeName === 'body' ? node.ownerDocument : node;\n}\n\nvar mixin = {\n  getForm: function getForm() {\n    return (0, _extends3['default'])({}, _createForm.mixin.getForm.call(this), {\n      validateFieldsAndScroll: this.validateFieldsAndScroll\n    });\n  },\n  validateFieldsAndScroll: function validateFieldsAndScroll(ns, opt, cb) {\n    var _this = this;\n\n    var _getParams = (0, _utils.getParams)(ns, opt, cb),\n        names = _getParams.names,\n        callback = _getParams.callback,\n        options = _getParams.options;\n\n    var newCb = function newCb(error, values) {\n      if (error) {\n        var validNames = _this.fieldsStore.getValidFieldsName();\n\n        var firstNode = void 0;\n        var firstTop = void 0;\n        validNames.forEach(function (name) {\n          if ((0, _has2['default'])(error, name)) {\n            var instance = _this.getFieldInstance(name);\n\n            if (instance) {\n              var node = _reactDom2['default'].findDOMNode(instance);\n\n              var top = node.getBoundingClientRect().top;\n\n              if (node.type !== 'hidden' && (firstTop === undefined || firstTop > top)) {\n                firstTop = top;\n                firstNode = node;\n              }\n            }\n          }\n        });\n\n        if (firstNode) {\n          var c = options.container || getScrollableContainer(firstNode);\n          (0, _domScrollIntoView2['default'])(firstNode, c, (0, _extends3['default'])({\n            onlyScrollIfNeeded: true\n          }, options.scroll));\n        }\n      }\n\n      if (typeof callback === 'function') {\n        callback(error, values);\n      }\n    };\n\n    return this.validateFields(names, options, newCb);\n  }\n};\n\nfunction createDOMForm(option) {\n  return (0, _createBaseForm2['default'])((0, _extends3['default'])({}, option), [mixin]);\n}\n\nexports['default'] = createDOMForm;\nmodule.exports = exports['default'];","map":{"version":3,"sources":["/Users/xumeihong/Documents/code/git/react/demos/demo2/node_modules/rc-form/lib/createDOMForm.js"],"names":["Object","defineProperty","exports","value","_extends2","require","_extends3","_interopRequireDefault","_reactDom","_reactDom2","_domScrollIntoView","_domScrollIntoView2","_has","_has2","_createBaseForm","_createBaseForm2","_createForm","_utils","obj","__esModule","computedStyle","el","prop","getComputedStyle","window","style","currentStyle","replace","word","letter","toUpperCase","undefined","getScrollableContainer","n","node","nodeName","toLowerCase","overflowY","scrollHeight","clientHeight","parentNode","ownerDocument","mixin","getForm","call","validateFieldsAndScroll","ns","opt","cb","_this","_getParams","getParams","names","callback","options","newCb","error","values","validNames","fieldsStore","getValidFieldsName","firstNode","firstTop","forEach","name","instance","getFieldInstance","findDOMNode","top","getBoundingClientRect","type","c","container","onlyScrollIfNeeded","scroll","validateFields","createDOMForm","option","module"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _reactDom = require('react-dom');\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _domScrollIntoView = require('dom-scroll-into-view');\n\nvar _domScrollIntoView2 = _interopRequireDefault(_domScrollIntoView);\n\nvar _has = require('lodash/has');\n\nvar _has2 = _interopRequireDefault(_has);\n\nvar _createBaseForm = require('./createBaseForm');\n\nvar _createBaseForm2 = _interopRequireDefault(_createBaseForm);\n\nvar _createForm = require('./createForm');\n\nvar _utils = require('./utils');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction computedStyle(el, prop) {\n  var getComputedStyle = window.getComputedStyle;\n  var style =\n  // If we have getComputedStyle\n  getComputedStyle ?\n  // Query it\n  // TODO: From CSS-Query notes, we might need (node, null) for FF\n  getComputedStyle(el) :\n\n  // Otherwise, we are in IE and use currentStyle\n  el.currentStyle;\n  if (style) {\n    return style[\n    // Switch to camelCase for CSSOM\n    // DEV: Grabbed from jQuery\n    // https://github.com/jquery/jquery/blob/1.9-stable/src/css.js#L191-L194\n    // https://github.com/jquery/jquery/blob/1.9-stable/src/core.js#L593-L597\n    prop.replace(/-(\\w)/gi, function (word, letter) {\n      return letter.toUpperCase();\n    })];\n  }\n  return undefined;\n}\n\nfunction getScrollableContainer(n) {\n  var node = n;\n  var nodeName = void 0;\n  /* eslint no-cond-assign:0 */\n  while ((nodeName = node.nodeName.toLowerCase()) !== 'body') {\n    var overflowY = computedStyle(node, 'overflowY');\n    // https://stackoverflow.com/a/36900407/3040605\n    if (node !== n && (overflowY === 'auto' || overflowY === 'scroll') && node.scrollHeight > node.clientHeight) {\n      return node;\n    }\n    node = node.parentNode;\n  }\n  return nodeName === 'body' ? node.ownerDocument : node;\n}\n\nvar mixin = {\n  getForm: function getForm() {\n    return (0, _extends3['default'])({}, _createForm.mixin.getForm.call(this), {\n      validateFieldsAndScroll: this.validateFieldsAndScroll\n    });\n  },\n  validateFieldsAndScroll: function validateFieldsAndScroll(ns, opt, cb) {\n    var _this = this;\n\n    var _getParams = (0, _utils.getParams)(ns, opt, cb),\n        names = _getParams.names,\n        callback = _getParams.callback,\n        options = _getParams.options;\n\n    var newCb = function newCb(error, values) {\n      if (error) {\n        var validNames = _this.fieldsStore.getValidFieldsName();\n        var firstNode = void 0;\n        var firstTop = void 0;\n\n        validNames.forEach(function (name) {\n          if ((0, _has2['default'])(error, name)) {\n            var instance = _this.getFieldInstance(name);\n            if (instance) {\n              var node = _reactDom2['default'].findDOMNode(instance);\n              var top = node.getBoundingClientRect().top;\n              if (node.type !== 'hidden' && (firstTop === undefined || firstTop > top)) {\n                firstTop = top;\n                firstNode = node;\n              }\n            }\n          }\n        });\n\n        if (firstNode) {\n          var c = options.container || getScrollableContainer(firstNode);\n          (0, _domScrollIntoView2['default'])(firstNode, c, (0, _extends3['default'])({\n            onlyScrollIfNeeded: true\n          }, options.scroll));\n        }\n      }\n\n      if (typeof callback === 'function') {\n        callback(error, values);\n      }\n    };\n\n    return this.validateFields(names, options, newCb);\n  }\n};\n\nfunction createDOMForm(option) {\n  return (0, _createBaseForm2['default'])((0, _extends3['default'])({}, option), [mixin]);\n}\n\nexports['default'] = createDOMForm;\nmodule.exports = exports['default'];"]},"metadata":{},"sourceType":"script"}