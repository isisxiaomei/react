{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _objectWithoutProperties2 = require('babel-runtime/helpers/objectWithoutProperties');\n\nvar _objectWithoutProperties3 = _interopRequireDefault(_objectWithoutProperties2);\n\nvar _defineProperty2 = require('babel-runtime/helpers/defineProperty');\n\nvar _defineProperty3 = _interopRequireDefault(_defineProperty2);\n\nvar _extends5 = require('babel-runtime/helpers/extends');\n\nvar _extends6 = _interopRequireDefault(_extends5);\n\nvar _toConsumableArray2 = require('babel-runtime/helpers/toConsumableArray');\n\nvar _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _createReactClass = require('create-react-class');\n\nvar _createReactClass2 = _interopRequireDefault(_createReactClass);\n\nvar _unsafeLifecyclesPolyfill = require('rc-util/lib/unsafeLifecyclesPolyfill');\n\nvar _unsafeLifecyclesPolyfill2 = _interopRequireDefault(_unsafeLifecyclesPolyfill);\n\nvar _asyncValidator = require('async-validator');\n\nvar _asyncValidator2 = _interopRequireDefault(_asyncValidator);\n\nvar _warning = require('warning');\n\nvar _warning2 = _interopRequireDefault(_warning);\n\nvar _get = require('lodash/get');\n\nvar _get2 = _interopRequireDefault(_get);\n\nvar _set = require('lodash/set');\n\nvar _set2 = _interopRequireDefault(_set);\n\nvar _eq = require('lodash/eq');\n\nvar _eq2 = _interopRequireDefault(_eq);\n\nvar _createFieldsStore = require('./createFieldsStore');\n\nvar _createFieldsStore2 = _interopRequireDefault(_createFieldsStore);\n\nvar _utils = require('./utils');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    'default': obj\n  };\n}\n/* eslint-disable react/prefer-es6-class */\n\n/* eslint-disable prefer-promise-reject-errors */\n\n\nvar DEFAULT_TRIGGER = 'onChange';\n\nfunction createBaseForm() {\n  var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var mixins = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var validateMessages = option.validateMessages,\n      onFieldsChange = option.onFieldsChange,\n      onValuesChange = option.onValuesChange,\n      _option$mapProps = option.mapProps,\n      mapProps = _option$mapProps === undefined ? _utils.identity : _option$mapProps,\n      mapPropsToFields = option.mapPropsToFields,\n      fieldNameProp = option.fieldNameProp,\n      fieldMetaProp = option.fieldMetaProp,\n      fieldDataProp = option.fieldDataProp,\n      _option$formPropName = option.formPropName,\n      formPropName = _option$formPropName === undefined ? 'form' : _option$formPropName,\n      formName = option.name,\n      withRef = option.withRef;\n  return function decorate(WrappedComponent) {\n    var Form = (0, _createReactClass2['default'])({\n      displayName: 'Form',\n      mixins: mixins,\n      getInitialState: function getInitialState() {\n        var _this = this;\n\n        var fields = mapPropsToFields && mapPropsToFields(this.props);\n        this.fieldsStore = (0, _createFieldsStore2['default'])(fields || {});\n        this.instances = {};\n        this.cachedBind = {};\n        this.clearedFieldMetaCache = {};\n        this.renderFields = {};\n        this.domFields = {}; // HACK: https://github.com/ant-design/ant-design/issues/6406\n\n        ['getFieldsValue', 'getFieldValue', 'setFieldsInitialValue', 'getFieldsError', 'getFieldError', 'isFieldValidating', 'isFieldsValidating', 'isFieldsTouched', 'isFieldTouched'].forEach(function (key) {\n          _this[key] = function () {\n            var _fieldsStore;\n\n            if (process.env.NODE_ENV !== 'production') {\n              (0, _warning2['default'])(false, 'you should not use `ref` on enhanced form, please use `wrappedComponentRef`. ' + 'See: https://github.com/react-component/form#note-use-wrappedcomponentref-instead-of-withref-after-rc-form140');\n            }\n\n            return (_fieldsStore = _this.fieldsStore)[key].apply(_fieldsStore, arguments);\n          };\n        });\n        return {\n          submitting: false\n        };\n      },\n      componentDidMount: function componentDidMount() {\n        this.cleanUpUselessFields();\n      },\n      componentWillReceiveProps: function componentWillReceiveProps(nextProps) {\n        if (mapPropsToFields) {\n          this.fieldsStore.updateFields(mapPropsToFields(nextProps));\n        }\n      },\n      componentDidUpdate: function componentDidUpdate() {\n        this.cleanUpUselessFields();\n      },\n      onCollectCommon: function onCollectCommon(name, action, args) {\n        var fieldMeta = this.fieldsStore.getFieldMeta(name);\n\n        if (fieldMeta[action]) {\n          fieldMeta[action].apply(fieldMeta, (0, _toConsumableArray3['default'])(args));\n        } else if (fieldMeta.originalProps && fieldMeta.originalProps[action]) {\n          var _fieldMeta$originalPr;\n\n          (_fieldMeta$originalPr = fieldMeta.originalProps)[action].apply(_fieldMeta$originalPr, (0, _toConsumableArray3['default'])(args));\n        }\n\n        var value = fieldMeta.getValueFromEvent ? fieldMeta.getValueFromEvent.apply(fieldMeta, (0, _toConsumableArray3['default'])(args)) : _utils.getValueFromEvent.apply(undefined, (0, _toConsumableArray3['default'])(args));\n\n        if (onValuesChange && value !== this.fieldsStore.getFieldValue(name)) {\n          var valuesAll = this.fieldsStore.getAllValues();\n          var valuesAllSet = {};\n          valuesAll[name] = value;\n          Object.keys(valuesAll).forEach(function (key) {\n            return (0, _set2['default'])(valuesAllSet, key, valuesAll[key]);\n          });\n          onValuesChange((0, _extends6['default'])((0, _defineProperty3['default'])({}, formPropName, this.getForm()), this.props), (0, _set2['default'])({}, name, value), valuesAllSet);\n        }\n\n        var field = this.fieldsStore.getField(name);\n        return {\n          name: name,\n          field: (0, _extends6['default'])({}, field, {\n            value: value,\n            touched: true\n          }),\n          fieldMeta: fieldMeta\n        };\n      },\n      onCollect: function onCollect(name_, action) {\n        for (var _len = arguments.length, args = Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n          args[_key - 2] = arguments[_key];\n        }\n\n        var _onCollectCommon = this.onCollectCommon(name_, action, args),\n            name = _onCollectCommon.name,\n            field = _onCollectCommon.field,\n            fieldMeta = _onCollectCommon.fieldMeta;\n\n        var validate = fieldMeta.validate;\n        this.fieldsStore.setFieldsAsDirty();\n        var newField = (0, _extends6['default'])({}, field, {\n          dirty: (0, _utils.hasRules)(validate)\n        });\n        this.setFields((0, _defineProperty3['default'])({}, name, newField));\n      },\n      onCollectValidate: function onCollectValidate(name_, action) {\n        for (var _len2 = arguments.length, args = Array(_len2 > 2 ? _len2 - 2 : 0), _key2 = 2; _key2 < _len2; _key2++) {\n          args[_key2 - 2] = arguments[_key2];\n        }\n\n        var _onCollectCommon2 = this.onCollectCommon(name_, action, args),\n            field = _onCollectCommon2.field,\n            fieldMeta = _onCollectCommon2.fieldMeta;\n\n        var newField = (0, _extends6['default'])({}, field, {\n          dirty: true\n        });\n        this.fieldsStore.setFieldsAsDirty();\n        this.validateFieldsInternal([newField], {\n          action: action,\n          options: {\n            firstFields: !!fieldMeta.validateFirst\n          }\n        });\n      },\n      getCacheBind: function getCacheBind(name, action, fn) {\n        if (!this.cachedBind[name]) {\n          this.cachedBind[name] = {};\n        }\n\n        var cache = this.cachedBind[name];\n\n        if (!cache[action] || cache[action].oriFn !== fn) {\n          cache[action] = {\n            fn: fn.bind(this, name, action),\n            oriFn: fn\n          };\n        }\n\n        return cache[action].fn;\n      },\n      getFieldDecorator: function getFieldDecorator(name, fieldOption) {\n        var _this2 = this;\n\n        var props = this.getFieldProps(name, fieldOption);\n        return function (fieldElem) {\n          // We should put field in record if it is rendered\n          _this2.renderFields[name] = true;\n\n          var fieldMeta = _this2.fieldsStore.getFieldMeta(name);\n\n          var originalProps = fieldElem.props;\n\n          if (process.env.NODE_ENV !== 'production') {\n            var valuePropName = fieldMeta.valuePropName;\n            (0, _warning2['default'])(!(valuePropName in originalProps), '`getFieldDecorator` will override `' + valuePropName + '`, ' + ('so please don\\'t set `' + valuePropName + '` directly ') + 'and use `setFieldsValue` to set it.');\n            var defaultValuePropName = 'default' + valuePropName[0].toUpperCase() + valuePropName.slice(1);\n            (0, _warning2['default'])(!(defaultValuePropName in originalProps), '`' + defaultValuePropName + '` is invalid ' + ('for `getFieldDecorator` will set `' + valuePropName + '`,') + ' please use `option.initialValue` instead.');\n          }\n\n          fieldMeta.originalProps = originalProps;\n          fieldMeta.ref = fieldElem.ref;\n          return _react2['default'].cloneElement(fieldElem, (0, _extends6['default'])({}, props, _this2.fieldsStore.getFieldValuePropValue(fieldMeta)));\n        };\n      },\n      getFieldProps: function getFieldProps(name) {\n        var _this3 = this;\n\n        var usersFieldOption = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n        if (!name) {\n          throw new Error('Must call `getFieldProps` with valid name string!');\n        }\n\n        if (process.env.NODE_ENV !== 'production') {\n          (0, _warning2['default'])(this.fieldsStore.isValidNestedFieldName(name), 'One field name cannot be part of another, e.g. `a` and `a.b`. Check field: ' + name);\n          (0, _warning2['default'])(!('exclusive' in usersFieldOption), '`option.exclusive` of `getFieldProps`|`getFieldDecorator` had been remove.');\n        }\n\n        delete this.clearedFieldMetaCache[name];\n        var fieldOption = (0, _extends6['default'])({\n          name: name,\n          trigger: DEFAULT_TRIGGER,\n          valuePropName: 'value',\n          validate: []\n        }, usersFieldOption);\n        var rules = fieldOption.rules,\n            trigger = fieldOption.trigger,\n            _fieldOption$validate = fieldOption.validateTrigger,\n            validateTrigger = _fieldOption$validate === undefined ? trigger : _fieldOption$validate,\n            validate = fieldOption.validate;\n        var fieldMeta = this.fieldsStore.getFieldMeta(name);\n\n        if ('initialValue' in fieldOption) {\n          fieldMeta.initialValue = fieldOption.initialValue;\n        }\n\n        var inputProps = (0, _extends6['default'])({}, this.fieldsStore.getFieldValuePropValue(fieldOption), {\n          ref: this.getCacheBind(name, name + '__ref', this.saveRef)\n        });\n\n        if (fieldNameProp) {\n          inputProps[fieldNameProp] = formName ? formName + '_' + name : name;\n        }\n\n        var validateRules = (0, _utils.normalizeValidateRules)(validate, rules, validateTrigger);\n        var validateTriggers = (0, _utils.getValidateTriggers)(validateRules);\n        validateTriggers.forEach(function (action) {\n          if (inputProps[action]) return;\n          inputProps[action] = _this3.getCacheBind(name, action, _this3.onCollectValidate);\n        }); // make sure that the value will be collect\n\n        if (trigger && validateTriggers.indexOf(trigger) === -1) {\n          inputProps[trigger] = this.getCacheBind(name, trigger, this.onCollect);\n        }\n\n        var meta = (0, _extends6['default'])({}, fieldMeta, fieldOption, {\n          validate: validateRules\n        });\n        this.fieldsStore.setFieldMeta(name, meta);\n\n        if (fieldMetaProp) {\n          inputProps[fieldMetaProp] = meta;\n        }\n\n        if (fieldDataProp) {\n          inputProps[fieldDataProp] = this.fieldsStore.getField(name);\n        } // This field is rendered, record it\n\n\n        this.renderFields[name] = true;\n        return inputProps;\n      },\n      getFieldInstance: function getFieldInstance(name) {\n        return this.instances[name];\n      },\n      getRules: function getRules(fieldMeta, action) {\n        var actionRules = fieldMeta.validate.filter(function (item) {\n          return !action || item.trigger.indexOf(action) >= 0;\n        }).map(function (item) {\n          return item.rules;\n        });\n        return (0, _utils.flattenArray)(actionRules);\n      },\n      setFields: function setFields(maybeNestedFields, callback) {\n        var _this4 = this;\n\n        var fields = this.fieldsStore.flattenRegisteredFields(maybeNestedFields);\n        this.fieldsStore.setFields(fields);\n\n        if (onFieldsChange) {\n          var changedFields = Object.keys(fields).reduce(function (acc, name) {\n            return (0, _set2['default'])(acc, name, _this4.fieldsStore.getField(name));\n          }, {});\n          onFieldsChange((0, _extends6['default'])((0, _defineProperty3['default'])({}, formPropName, this.getForm()), this.props), changedFields, this.fieldsStore.getNestedAllFields());\n        }\n\n        this.forceUpdate(callback);\n      },\n      setFieldsValue: function setFieldsValue(changedValues, callback) {\n        var fieldsMeta = this.fieldsStore.fieldsMeta;\n        var values = this.fieldsStore.flattenRegisteredFields(changedValues);\n        var newFields = Object.keys(values).reduce(function (acc, name) {\n          var isRegistered = fieldsMeta[name];\n\n          if (process.env.NODE_ENV !== 'production') {\n            (0, _warning2['default'])(isRegistered, 'Cannot use `setFieldsValue` until ' + 'you use `getFieldDecorator` or `getFieldProps` to register it.');\n          }\n\n          if (isRegistered) {\n            var value = values[name];\n            acc[name] = {\n              value: value\n            };\n          }\n\n          return acc;\n        }, {});\n        this.setFields(newFields, callback);\n\n        if (onValuesChange) {\n          var allValues = this.fieldsStore.getAllValues();\n          onValuesChange((0, _extends6['default'])((0, _defineProperty3['default'])({}, formPropName, this.getForm()), this.props), changedValues, allValues);\n        }\n      },\n      saveRef: function saveRef(name, _, component) {\n        if (!component) {\n          var _fieldMeta = this.fieldsStore.getFieldMeta(name);\n\n          if (!_fieldMeta.preserve) {\n            // after destroy, delete data\n            this.clearedFieldMetaCache[name] = {\n              field: this.fieldsStore.getField(name),\n              meta: _fieldMeta\n            };\n            this.clearField(name);\n          }\n\n          delete this.domFields[name];\n          return;\n        }\n\n        this.domFields[name] = true;\n        this.recoverClearedField(name);\n        var fieldMeta = this.fieldsStore.getFieldMeta(name);\n\n        if (fieldMeta) {\n          var ref = fieldMeta.ref;\n\n          if (ref) {\n            if (typeof ref === 'string') {\n              throw new Error('can not set ref string for ' + name);\n            } else if (typeof ref === 'function') {\n              ref(component);\n            } else if (Object.prototype.hasOwnProperty.call(ref, 'current')) {\n              ref.current = component;\n            }\n          }\n        }\n\n        this.instances[name] = component;\n      },\n      cleanUpUselessFields: function cleanUpUselessFields() {\n        var _this5 = this;\n\n        var fieldList = this.fieldsStore.getAllFieldsName();\n        var removedList = fieldList.filter(function (field) {\n          var fieldMeta = _this5.fieldsStore.getFieldMeta(field);\n\n          return !_this5.renderFields[field] && !_this5.domFields[field] && !fieldMeta.preserve;\n        });\n\n        if (removedList.length) {\n          removedList.forEach(this.clearField);\n        }\n\n        this.renderFields = {};\n      },\n      clearField: function clearField(name) {\n        this.fieldsStore.clearField(name);\n        delete this.instances[name];\n        delete this.cachedBind[name];\n      },\n      resetFields: function resetFields(ns) {\n        var _this6 = this;\n\n        var newFields = this.fieldsStore.resetFields(ns);\n\n        if (Object.keys(newFields).length > 0) {\n          this.setFields(newFields);\n        }\n\n        if (ns) {\n          var names = Array.isArray(ns) ? ns : [ns];\n          names.forEach(function (name) {\n            return delete _this6.clearedFieldMetaCache[name];\n          });\n        } else {\n          this.clearedFieldMetaCache = {};\n        }\n      },\n      recoverClearedField: function recoverClearedField(name) {\n        if (this.clearedFieldMetaCache[name]) {\n          this.fieldsStore.setFields((0, _defineProperty3['default'])({}, name, this.clearedFieldMetaCache[name].field));\n          this.fieldsStore.setFieldMeta(name, this.clearedFieldMetaCache[name].meta);\n          delete this.clearedFieldMetaCache[name];\n        }\n      },\n      validateFieldsInternal: function validateFieldsInternal(fields, _ref, callback) {\n        var _this7 = this;\n\n        var fieldNames = _ref.fieldNames,\n            action = _ref.action,\n            _ref$options = _ref.options,\n            options = _ref$options === undefined ? {} : _ref$options;\n        var allRules = {};\n        var allValues = {};\n        var allFields = {};\n        var alreadyErrors = {};\n        fields.forEach(function (field) {\n          var name = field.name;\n\n          if (options.force !== true && field.dirty === false) {\n            if (field.errors) {\n              (0, _set2['default'])(alreadyErrors, name, {\n                errors: field.errors\n              });\n            }\n\n            return;\n          }\n\n          var fieldMeta = _this7.fieldsStore.getFieldMeta(name);\n\n          var newField = (0, _extends6['default'])({}, field);\n          newField.errors = undefined;\n          newField.validating = true;\n          newField.dirty = true;\n          allRules[name] = _this7.getRules(fieldMeta, action);\n          allValues[name] = newField.value;\n          allFields[name] = newField;\n        });\n        this.setFields(allFields); // in case normalize\n\n        Object.keys(allValues).forEach(function (f) {\n          allValues[f] = _this7.fieldsStore.getFieldValue(f);\n        });\n\n        if (callback && (0, _utils.isEmptyObject)(allFields)) {\n          callback((0, _utils.isEmptyObject)(alreadyErrors) ? null : alreadyErrors, this.fieldsStore.getFieldsValue(fieldNames));\n          return;\n        }\n\n        var validator = new _asyncValidator2['default'](allRules);\n\n        if (validateMessages) {\n          validator.messages(validateMessages);\n        }\n\n        validator.validate(allValues, options, function (errors) {\n          var errorsGroup = (0, _extends6['default'])({}, alreadyErrors);\n\n          if (errors && errors.length) {\n            errors.forEach(function (e) {\n              var errorFieldName = e.field;\n              var fieldName = errorFieldName; // Handle using array validation rule.\n              // ref: https://github.com/ant-design/ant-design/issues/14275\n\n              Object.keys(allRules).some(function (ruleFieldName) {\n                var rules = allRules[ruleFieldName] || []; // Exist if match rule\n\n                if (ruleFieldName === errorFieldName) {\n                  fieldName = ruleFieldName;\n                  return true;\n                } // Skip if not match array type\n\n\n                if (rules.every(function (_ref2) {\n                  var type = _ref2.type;\n                  return type !== 'array';\n                }) || errorFieldName.indexOf(ruleFieldName + '.') !== 0) {\n                  return false;\n                } // Exist if match the field name\n\n\n                var restPath = errorFieldName.slice(ruleFieldName.length + 1);\n\n                if (/^\\d+$/.test(restPath)) {\n                  fieldName = ruleFieldName;\n                  return true;\n                }\n\n                return false;\n              });\n              var field = (0, _get2['default'])(errorsGroup, fieldName);\n\n              if (typeof field !== 'object' || Array.isArray(field)) {\n                (0, _set2['default'])(errorsGroup, fieldName, {\n                  errors: []\n                });\n              }\n\n              var fieldErrors = (0, _get2['default'])(errorsGroup, fieldName.concat('.errors'));\n              fieldErrors.push(e);\n            });\n          }\n\n          var expired = [];\n          var nowAllFields = {};\n          Object.keys(allRules).forEach(function (name) {\n            var fieldErrors = (0, _get2['default'])(errorsGroup, name);\n\n            var nowField = _this7.fieldsStore.getField(name); // avoid concurrency problems\n\n\n            if (!(0, _eq2['default'])(nowField.value, allValues[name])) {\n              expired.push({\n                name: name\n              });\n            } else {\n              nowField.errors = fieldErrors && fieldErrors.errors;\n              nowField.value = allValues[name];\n              nowField.validating = false;\n              nowField.dirty = false;\n              nowAllFields[name] = nowField;\n            }\n          });\n\n          _this7.setFields(nowAllFields);\n\n          if (callback) {\n            if (expired.length) {\n              expired.forEach(function (_ref3) {\n                var name = _ref3.name;\n                var fieldErrors = [{\n                  message: name + ' need to revalidate',\n                  field: name\n                }];\n                (0, _set2['default'])(errorsGroup, name, {\n                  expired: true,\n                  errors: fieldErrors\n                });\n              });\n            }\n\n            callback((0, _utils.isEmptyObject)(errorsGroup) ? null : errorsGroup, _this7.fieldsStore.getFieldsValue(fieldNames));\n          }\n        });\n      },\n      validateFields: function validateFields(ns, opt, cb) {\n        var _this8 = this;\n\n        var pending = new Promise(function (resolve, reject) {\n          var _getParams = (0, _utils.getParams)(ns, opt, cb),\n              names = _getParams.names,\n              options = _getParams.options;\n\n          var _getParams2 = (0, _utils.getParams)(ns, opt, cb),\n              callback = _getParams2.callback;\n\n          if (!callback || typeof callback === 'function') {\n            var oldCb = callback;\n\n            callback = function callback(errors, values) {\n              if (oldCb) {\n                oldCb(errors, values);\n              }\n\n              if (errors) {\n                reject({\n                  errors: errors,\n                  values: values\n                });\n              } else {\n                resolve(values);\n              }\n            };\n          }\n\n          var fieldNames = names ? _this8.fieldsStore.getValidFieldsFullName(names) : _this8.fieldsStore.getValidFieldsName();\n          var fields = fieldNames.filter(function (name) {\n            var fieldMeta = _this8.fieldsStore.getFieldMeta(name);\n\n            return (0, _utils.hasRules)(fieldMeta.validate);\n          }).map(function (name) {\n            var field = _this8.fieldsStore.getField(name);\n\n            field.value = _this8.fieldsStore.getFieldValue(name);\n            return field;\n          });\n\n          if (!fields.length) {\n            callback(null, _this8.fieldsStore.getFieldsValue(fieldNames));\n            return;\n          }\n\n          if (!('firstFields' in options)) {\n            options.firstFields = fieldNames.filter(function (name) {\n              var fieldMeta = _this8.fieldsStore.getFieldMeta(name);\n\n              return !!fieldMeta.validateFirst;\n            });\n          }\n\n          _this8.validateFieldsInternal(fields, {\n            fieldNames: fieldNames,\n            options: options\n          }, callback);\n        });\n        pending['catch'](function (e) {\n          // eslint-disable-next-line no-console\n          if (console.error && process.env.NODE_ENV !== 'production') {\n            // eslint-disable-next-line no-console\n            console.error(e);\n          }\n\n          return e;\n        });\n        return pending;\n      },\n      isSubmitting: function isSubmitting() {\n        if (process.env.NODE_ENV !== 'production' && process.env.NODE_ENV !== 'test') {\n          (0, _warning2['default'])(false, '`isSubmitting` is deprecated. ' + \"Actually, it's more convenient to handle submitting status by yourself.\");\n        }\n\n        return this.state.submitting;\n      },\n      submit: function submit(callback) {\n        var _this9 = this;\n\n        if (process.env.NODE_ENV !== 'production' && process.env.NODE_ENV !== 'test') {\n          (0, _warning2['default'])(false, '`submit` is deprecated. ' + \"Actually, it's more convenient to handle submitting status by yourself.\");\n        }\n\n        var fn = function fn() {\n          _this9.setState({\n            submitting: false\n          });\n        };\n\n        this.setState({\n          submitting: true\n        });\n        callback(fn);\n      },\n      render: function render() {\n        var _props = this.props,\n            wrappedComponentRef = _props.wrappedComponentRef,\n            restProps = (0, _objectWithoutProperties3['default'])(_props, ['wrappedComponentRef']); // eslint-disable-line\n\n        var formProps = (0, _defineProperty3['default'])({}, formPropName, this.getForm());\n\n        if (withRef) {\n          if (process.env.NODE_ENV !== 'production' && process.env.NODE_ENV !== 'test') {\n            (0, _warning2['default'])(false, '`withRef` is deprecated, please use `wrappedComponentRef` instead. ' + 'See: https://github.com/react-component/form#note-use-wrappedcomponentref-instead-of-withref-after-rc-form140');\n          }\n\n          formProps.ref = 'wrappedComponent';\n        } else if (wrappedComponentRef) {\n          formProps.ref = wrappedComponentRef;\n        }\n\n        var props = mapProps.call(this, (0, _extends6['default'])({}, formProps, restProps));\n        return _react2['default'].createElement(WrappedComponent, props);\n      }\n    });\n    return (0, _utils.argumentContainer)((0, _unsafeLifecyclesPolyfill2['default'])(Form), WrappedComponent);\n  };\n}\n\nexports['default'] = createBaseForm;\nmodule.exports = exports['default'];","map":{"version":3,"sources":["/Users/xumeihong/Documents/code/git/react/demos/demo2/node_modules/rc-form/lib/createBaseForm.js"],"names":["Object","defineProperty","exports","value","_objectWithoutProperties2","require","_objectWithoutProperties3","_interopRequireDefault","_defineProperty2","_defineProperty3","_extends5","_extends6","_toConsumableArray2","_toConsumableArray3","_react","_react2","_createReactClass","_createReactClass2","_unsafeLifecyclesPolyfill","_unsafeLifecyclesPolyfill2","_asyncValidator","_asyncValidator2","_warning","_warning2","_get","_get2","_set","_set2","_eq","_eq2","_createFieldsStore","_createFieldsStore2","_utils","obj","__esModule","DEFAULT_TRIGGER","createBaseForm","option","arguments","length","undefined","mixins","validateMessages","onFieldsChange","onValuesChange","_option$mapProps","mapProps","identity","mapPropsToFields","fieldNameProp","fieldMetaProp","fieldDataProp","_option$formPropName","formPropName","formName","name","withRef","decorate","WrappedComponent","Form","displayName","getInitialState","_this","fields","props","fieldsStore","instances","cachedBind","clearedFieldMetaCache","renderFields","domFields","forEach","key","_fieldsStore","process","env","NODE_ENV","apply","submitting","componentDidMount","cleanUpUselessFields","componentWillReceiveProps","nextProps","updateFields","componentDidUpdate","onCollectCommon","action","args","fieldMeta","getFieldMeta","originalProps","_fieldMeta$originalPr","getValueFromEvent","getFieldValue","valuesAll","getAllValues","valuesAllSet","keys","getForm","field","getField","touched","onCollect","name_","_len","Array","_key","_onCollectCommon","validate","setFieldsAsDirty","newField","dirty","hasRules","setFields","onCollectValidate","_len2","_key2","_onCollectCommon2","validateFieldsInternal","options","firstFields","validateFirst","getCacheBind","fn","cache","oriFn","bind","getFieldDecorator","fieldOption","_this2","getFieldProps","fieldElem","valuePropName","defaultValuePropName","toUpperCase","slice","ref","cloneElement","getFieldValuePropValue","_this3","usersFieldOption","Error","isValidNestedFieldName","trigger","rules","_fieldOption$validate","validateTrigger","initialValue","inputProps","saveRef","validateRules","normalizeValidateRules","validateTriggers","getValidateTriggers","indexOf","meta","setFieldMeta","getFieldInstance","getRules","actionRules","filter","item","map","flattenArray","maybeNestedFields","callback","_this4","flattenRegisteredFields","changedFields","reduce","acc","getNestedAllFields","forceUpdate","setFieldsValue","changedValues","fieldsMeta","values","newFields","isRegistered","allValues","_","component","_fieldMeta","preserve","clearField","recoverClearedField","prototype","hasOwnProperty","call","current","_this5","fieldList","getAllFieldsName","removedList","resetFields","ns","_this6","names","isArray","_ref","_this7","fieldNames","_ref$options","allRules","allFields","alreadyErrors","force","errors","validating","f","isEmptyObject","getFieldsValue","validator","messages","errorsGroup","e","errorFieldName","fieldName","some","ruleFieldName","every","_ref2","type","restPath","test","fieldErrors","concat","push","expired","nowAllFields","nowField","_ref3","message","validateFields","opt","cb","_this8","pending","Promise","resolve","reject","_getParams","getParams","_getParams2","oldCb","getValidFieldsFullName","getValidFieldsName","console","error","isSubmitting","state","submit","_this9","setState","render","_props","wrappedComponentRef","restProps","formProps","createElement","argumentContainer","module"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _objectWithoutProperties2 = require('babel-runtime/helpers/objectWithoutProperties');\n\nvar _objectWithoutProperties3 = _interopRequireDefault(_objectWithoutProperties2);\n\nvar _defineProperty2 = require('babel-runtime/helpers/defineProperty');\n\nvar _defineProperty3 = _interopRequireDefault(_defineProperty2);\n\nvar _extends5 = require('babel-runtime/helpers/extends');\n\nvar _extends6 = _interopRequireDefault(_extends5);\n\nvar _toConsumableArray2 = require('babel-runtime/helpers/toConsumableArray');\n\nvar _toConsumableArray3 = _interopRequireDefault(_toConsumableArray2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _createReactClass = require('create-react-class');\n\nvar _createReactClass2 = _interopRequireDefault(_createReactClass);\n\nvar _unsafeLifecyclesPolyfill = require('rc-util/lib/unsafeLifecyclesPolyfill');\n\nvar _unsafeLifecyclesPolyfill2 = _interopRequireDefault(_unsafeLifecyclesPolyfill);\n\nvar _asyncValidator = require('async-validator');\n\nvar _asyncValidator2 = _interopRequireDefault(_asyncValidator);\n\nvar _warning = require('warning');\n\nvar _warning2 = _interopRequireDefault(_warning);\n\nvar _get = require('lodash/get');\n\nvar _get2 = _interopRequireDefault(_get);\n\nvar _set = require('lodash/set');\n\nvar _set2 = _interopRequireDefault(_set);\n\nvar _eq = require('lodash/eq');\n\nvar _eq2 = _interopRequireDefault(_eq);\n\nvar _createFieldsStore = require('./createFieldsStore');\n\nvar _createFieldsStore2 = _interopRequireDefault(_createFieldsStore);\n\nvar _utils = require('./utils');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n/* eslint-disable react/prefer-es6-class */\n/* eslint-disable prefer-promise-reject-errors */\n\nvar DEFAULT_TRIGGER = 'onChange';\n\nfunction createBaseForm() {\n  var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var mixins = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var validateMessages = option.validateMessages,\n      onFieldsChange = option.onFieldsChange,\n      onValuesChange = option.onValuesChange,\n      _option$mapProps = option.mapProps,\n      mapProps = _option$mapProps === undefined ? _utils.identity : _option$mapProps,\n      mapPropsToFields = option.mapPropsToFields,\n      fieldNameProp = option.fieldNameProp,\n      fieldMetaProp = option.fieldMetaProp,\n      fieldDataProp = option.fieldDataProp,\n      _option$formPropName = option.formPropName,\n      formPropName = _option$formPropName === undefined ? 'form' : _option$formPropName,\n      formName = option.name,\n      withRef = option.withRef;\n\n\n  return function decorate(WrappedComponent) {\n    var Form = (0, _createReactClass2['default'])({\n      displayName: 'Form',\n\n      mixins: mixins,\n\n      getInitialState: function getInitialState() {\n        var _this = this;\n\n        var fields = mapPropsToFields && mapPropsToFields(this.props);\n        this.fieldsStore = (0, _createFieldsStore2['default'])(fields || {});\n\n        this.instances = {};\n        this.cachedBind = {};\n        this.clearedFieldMetaCache = {};\n\n        this.renderFields = {};\n        this.domFields = {};\n\n        // HACK: https://github.com/ant-design/ant-design/issues/6406\n        ['getFieldsValue', 'getFieldValue', 'setFieldsInitialValue', 'getFieldsError', 'getFieldError', 'isFieldValidating', 'isFieldsValidating', 'isFieldsTouched', 'isFieldTouched'].forEach(function (key) {\n          _this[key] = function () {\n            var _fieldsStore;\n\n            if (process.env.NODE_ENV !== 'production') {\n              (0, _warning2['default'])(false, 'you should not use `ref` on enhanced form, please use `wrappedComponentRef`. ' + 'See: https://github.com/react-component/form#note-use-wrappedcomponentref-instead-of-withref-after-rc-form140');\n            }\n            return (_fieldsStore = _this.fieldsStore)[key].apply(_fieldsStore, arguments);\n          };\n        });\n\n        return {\n          submitting: false\n        };\n      },\n      componentDidMount: function componentDidMount() {\n        this.cleanUpUselessFields();\n      },\n      componentWillReceiveProps: function componentWillReceiveProps(nextProps) {\n        if (mapPropsToFields) {\n          this.fieldsStore.updateFields(mapPropsToFields(nextProps));\n        }\n      },\n      componentDidUpdate: function componentDidUpdate() {\n        this.cleanUpUselessFields();\n      },\n      onCollectCommon: function onCollectCommon(name, action, args) {\n        var fieldMeta = this.fieldsStore.getFieldMeta(name);\n        if (fieldMeta[action]) {\n          fieldMeta[action].apply(fieldMeta, (0, _toConsumableArray3['default'])(args));\n        } else if (fieldMeta.originalProps && fieldMeta.originalProps[action]) {\n          var _fieldMeta$originalPr;\n\n          (_fieldMeta$originalPr = fieldMeta.originalProps)[action].apply(_fieldMeta$originalPr, (0, _toConsumableArray3['default'])(args));\n        }\n        var value = fieldMeta.getValueFromEvent ? fieldMeta.getValueFromEvent.apply(fieldMeta, (0, _toConsumableArray3['default'])(args)) : _utils.getValueFromEvent.apply(undefined, (0, _toConsumableArray3['default'])(args));\n        if (onValuesChange && value !== this.fieldsStore.getFieldValue(name)) {\n          var valuesAll = this.fieldsStore.getAllValues();\n          var valuesAllSet = {};\n          valuesAll[name] = value;\n          Object.keys(valuesAll).forEach(function (key) {\n            return (0, _set2['default'])(valuesAllSet, key, valuesAll[key]);\n          });\n          onValuesChange((0, _extends6['default'])((0, _defineProperty3['default'])({}, formPropName, this.getForm()), this.props), (0, _set2['default'])({}, name, value), valuesAllSet);\n        }\n        var field = this.fieldsStore.getField(name);\n        return { name: name, field: (0, _extends6['default'])({}, field, { value: value, touched: true }), fieldMeta: fieldMeta };\n      },\n      onCollect: function onCollect(name_, action) {\n        for (var _len = arguments.length, args = Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n          args[_key - 2] = arguments[_key];\n        }\n\n        var _onCollectCommon = this.onCollectCommon(name_, action, args),\n            name = _onCollectCommon.name,\n            field = _onCollectCommon.field,\n            fieldMeta = _onCollectCommon.fieldMeta;\n\n        var validate = fieldMeta.validate;\n\n\n        this.fieldsStore.setFieldsAsDirty();\n\n        var newField = (0, _extends6['default'])({}, field, {\n          dirty: (0, _utils.hasRules)(validate)\n        });\n        this.setFields((0, _defineProperty3['default'])({}, name, newField));\n      },\n      onCollectValidate: function onCollectValidate(name_, action) {\n        for (var _len2 = arguments.length, args = Array(_len2 > 2 ? _len2 - 2 : 0), _key2 = 2; _key2 < _len2; _key2++) {\n          args[_key2 - 2] = arguments[_key2];\n        }\n\n        var _onCollectCommon2 = this.onCollectCommon(name_, action, args),\n            field = _onCollectCommon2.field,\n            fieldMeta = _onCollectCommon2.fieldMeta;\n\n        var newField = (0, _extends6['default'])({}, field, {\n          dirty: true\n        });\n\n        this.fieldsStore.setFieldsAsDirty();\n\n        this.validateFieldsInternal([newField], {\n          action: action,\n          options: {\n            firstFields: !!fieldMeta.validateFirst\n          }\n        });\n      },\n      getCacheBind: function getCacheBind(name, action, fn) {\n        if (!this.cachedBind[name]) {\n          this.cachedBind[name] = {};\n        }\n        var cache = this.cachedBind[name];\n        if (!cache[action] || cache[action].oriFn !== fn) {\n          cache[action] = {\n            fn: fn.bind(this, name, action),\n            oriFn: fn\n          };\n        }\n        return cache[action].fn;\n      },\n      getFieldDecorator: function getFieldDecorator(name, fieldOption) {\n        var _this2 = this;\n\n        var props = this.getFieldProps(name, fieldOption);\n        return function (fieldElem) {\n          // We should put field in record if it is rendered\n          _this2.renderFields[name] = true;\n\n          var fieldMeta = _this2.fieldsStore.getFieldMeta(name);\n          var originalProps = fieldElem.props;\n          if (process.env.NODE_ENV !== 'production') {\n            var valuePropName = fieldMeta.valuePropName;\n            (0, _warning2['default'])(!(valuePropName in originalProps), '`getFieldDecorator` will override `' + valuePropName + '`, ' + ('so please don\\'t set `' + valuePropName + '` directly ') + 'and use `setFieldsValue` to set it.');\n            var defaultValuePropName = 'default' + valuePropName[0].toUpperCase() + valuePropName.slice(1);\n            (0, _warning2['default'])(!(defaultValuePropName in originalProps), '`' + defaultValuePropName + '` is invalid ' + ('for `getFieldDecorator` will set `' + valuePropName + '`,') + ' please use `option.initialValue` instead.');\n          }\n          fieldMeta.originalProps = originalProps;\n          fieldMeta.ref = fieldElem.ref;\n          return _react2['default'].cloneElement(fieldElem, (0, _extends6['default'])({}, props, _this2.fieldsStore.getFieldValuePropValue(fieldMeta)));\n        };\n      },\n      getFieldProps: function getFieldProps(name) {\n        var _this3 = this;\n\n        var usersFieldOption = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n        if (!name) {\n          throw new Error('Must call `getFieldProps` with valid name string!');\n        }\n        if (process.env.NODE_ENV !== 'production') {\n          (0, _warning2['default'])(this.fieldsStore.isValidNestedFieldName(name), 'One field name cannot be part of another, e.g. `a` and `a.b`. Check field: ' + name);\n          (0, _warning2['default'])(!('exclusive' in usersFieldOption), '`option.exclusive` of `getFieldProps`|`getFieldDecorator` had been remove.');\n        }\n\n        delete this.clearedFieldMetaCache[name];\n\n        var fieldOption = (0, _extends6['default'])({\n          name: name,\n          trigger: DEFAULT_TRIGGER,\n          valuePropName: 'value',\n          validate: []\n        }, usersFieldOption);\n\n        var rules = fieldOption.rules,\n            trigger = fieldOption.trigger,\n            _fieldOption$validate = fieldOption.validateTrigger,\n            validateTrigger = _fieldOption$validate === undefined ? trigger : _fieldOption$validate,\n            validate = fieldOption.validate;\n\n\n        var fieldMeta = this.fieldsStore.getFieldMeta(name);\n        if ('initialValue' in fieldOption) {\n          fieldMeta.initialValue = fieldOption.initialValue;\n        }\n\n        var inputProps = (0, _extends6['default'])({}, this.fieldsStore.getFieldValuePropValue(fieldOption), {\n          ref: this.getCacheBind(name, name + '__ref', this.saveRef)\n        });\n        if (fieldNameProp) {\n          inputProps[fieldNameProp] = formName ? formName + '_' + name : name;\n        }\n\n        var validateRules = (0, _utils.normalizeValidateRules)(validate, rules, validateTrigger);\n        var validateTriggers = (0, _utils.getValidateTriggers)(validateRules);\n        validateTriggers.forEach(function (action) {\n          if (inputProps[action]) return;\n          inputProps[action] = _this3.getCacheBind(name, action, _this3.onCollectValidate);\n        });\n\n        // make sure that the value will be collect\n        if (trigger && validateTriggers.indexOf(trigger) === -1) {\n          inputProps[trigger] = this.getCacheBind(name, trigger, this.onCollect);\n        }\n\n        var meta = (0, _extends6['default'])({}, fieldMeta, fieldOption, {\n          validate: validateRules\n        });\n        this.fieldsStore.setFieldMeta(name, meta);\n        if (fieldMetaProp) {\n          inputProps[fieldMetaProp] = meta;\n        }\n\n        if (fieldDataProp) {\n          inputProps[fieldDataProp] = this.fieldsStore.getField(name);\n        }\n\n        // This field is rendered, record it\n        this.renderFields[name] = true;\n\n        return inputProps;\n      },\n      getFieldInstance: function getFieldInstance(name) {\n        return this.instances[name];\n      },\n      getRules: function getRules(fieldMeta, action) {\n        var actionRules = fieldMeta.validate.filter(function (item) {\n          return !action || item.trigger.indexOf(action) >= 0;\n        }).map(function (item) {\n          return item.rules;\n        });\n        return (0, _utils.flattenArray)(actionRules);\n      },\n      setFields: function setFields(maybeNestedFields, callback) {\n        var _this4 = this;\n\n        var fields = this.fieldsStore.flattenRegisteredFields(maybeNestedFields);\n        this.fieldsStore.setFields(fields);\n        if (onFieldsChange) {\n          var changedFields = Object.keys(fields).reduce(function (acc, name) {\n            return (0, _set2['default'])(acc, name, _this4.fieldsStore.getField(name));\n          }, {});\n          onFieldsChange((0, _extends6['default'])((0, _defineProperty3['default'])({}, formPropName, this.getForm()), this.props), changedFields, this.fieldsStore.getNestedAllFields());\n        }\n        this.forceUpdate(callback);\n      },\n      setFieldsValue: function setFieldsValue(changedValues, callback) {\n        var fieldsMeta = this.fieldsStore.fieldsMeta;\n\n        var values = this.fieldsStore.flattenRegisteredFields(changedValues);\n        var newFields = Object.keys(values).reduce(function (acc, name) {\n          var isRegistered = fieldsMeta[name];\n          if (process.env.NODE_ENV !== 'production') {\n            (0, _warning2['default'])(isRegistered, 'Cannot use `setFieldsValue` until ' + 'you use `getFieldDecorator` or `getFieldProps` to register it.');\n          }\n          if (isRegistered) {\n            var value = values[name];\n            acc[name] = {\n              value: value\n            };\n          }\n          return acc;\n        }, {});\n        this.setFields(newFields, callback);\n        if (onValuesChange) {\n          var allValues = this.fieldsStore.getAllValues();\n          onValuesChange((0, _extends6['default'])((0, _defineProperty3['default'])({}, formPropName, this.getForm()), this.props), changedValues, allValues);\n        }\n      },\n      saveRef: function saveRef(name, _, component) {\n        if (!component) {\n          var _fieldMeta = this.fieldsStore.getFieldMeta(name);\n          if (!_fieldMeta.preserve) {\n            // after destroy, delete data\n            this.clearedFieldMetaCache[name] = {\n              field: this.fieldsStore.getField(name),\n              meta: _fieldMeta\n            };\n            this.clearField(name);\n          }\n          delete this.domFields[name];\n          return;\n        }\n        this.domFields[name] = true;\n        this.recoverClearedField(name);\n        var fieldMeta = this.fieldsStore.getFieldMeta(name);\n        if (fieldMeta) {\n          var ref = fieldMeta.ref;\n          if (ref) {\n            if (typeof ref === 'string') {\n              throw new Error('can not set ref string for ' + name);\n            } else if (typeof ref === 'function') {\n              ref(component);\n            } else if (Object.prototype.hasOwnProperty.call(ref, 'current')) {\n              ref.current = component;\n            }\n          }\n        }\n        this.instances[name] = component;\n      },\n      cleanUpUselessFields: function cleanUpUselessFields() {\n        var _this5 = this;\n\n        var fieldList = this.fieldsStore.getAllFieldsName();\n        var removedList = fieldList.filter(function (field) {\n          var fieldMeta = _this5.fieldsStore.getFieldMeta(field);\n          return !_this5.renderFields[field] && !_this5.domFields[field] && !fieldMeta.preserve;\n        });\n        if (removedList.length) {\n          removedList.forEach(this.clearField);\n        }\n        this.renderFields = {};\n      },\n      clearField: function clearField(name) {\n        this.fieldsStore.clearField(name);\n        delete this.instances[name];\n        delete this.cachedBind[name];\n      },\n      resetFields: function resetFields(ns) {\n        var _this6 = this;\n\n        var newFields = this.fieldsStore.resetFields(ns);\n        if (Object.keys(newFields).length > 0) {\n          this.setFields(newFields);\n        }\n        if (ns) {\n          var names = Array.isArray(ns) ? ns : [ns];\n          names.forEach(function (name) {\n            return delete _this6.clearedFieldMetaCache[name];\n          });\n        } else {\n          this.clearedFieldMetaCache = {};\n        }\n      },\n      recoverClearedField: function recoverClearedField(name) {\n        if (this.clearedFieldMetaCache[name]) {\n          this.fieldsStore.setFields((0, _defineProperty3['default'])({}, name, this.clearedFieldMetaCache[name].field));\n          this.fieldsStore.setFieldMeta(name, this.clearedFieldMetaCache[name].meta);\n          delete this.clearedFieldMetaCache[name];\n        }\n      },\n      validateFieldsInternal: function validateFieldsInternal(fields, _ref, callback) {\n        var _this7 = this;\n\n        var fieldNames = _ref.fieldNames,\n            action = _ref.action,\n            _ref$options = _ref.options,\n            options = _ref$options === undefined ? {} : _ref$options;\n\n        var allRules = {};\n        var allValues = {};\n        var allFields = {};\n        var alreadyErrors = {};\n        fields.forEach(function (field) {\n          var name = field.name;\n          if (options.force !== true && field.dirty === false) {\n            if (field.errors) {\n              (0, _set2['default'])(alreadyErrors, name, { errors: field.errors });\n            }\n            return;\n          }\n          var fieldMeta = _this7.fieldsStore.getFieldMeta(name);\n          var newField = (0, _extends6['default'])({}, field);\n          newField.errors = undefined;\n          newField.validating = true;\n          newField.dirty = true;\n          allRules[name] = _this7.getRules(fieldMeta, action);\n          allValues[name] = newField.value;\n          allFields[name] = newField;\n        });\n        this.setFields(allFields);\n        // in case normalize\n        Object.keys(allValues).forEach(function (f) {\n          allValues[f] = _this7.fieldsStore.getFieldValue(f);\n        });\n        if (callback && (0, _utils.isEmptyObject)(allFields)) {\n          callback((0, _utils.isEmptyObject)(alreadyErrors) ? null : alreadyErrors, this.fieldsStore.getFieldsValue(fieldNames));\n          return;\n        }\n        var validator = new _asyncValidator2['default'](allRules);\n        if (validateMessages) {\n          validator.messages(validateMessages);\n        }\n        validator.validate(allValues, options, function (errors) {\n          var errorsGroup = (0, _extends6['default'])({}, alreadyErrors);\n          if (errors && errors.length) {\n            errors.forEach(function (e) {\n              var errorFieldName = e.field;\n              var fieldName = errorFieldName;\n\n              // Handle using array validation rule.\n              // ref: https://github.com/ant-design/ant-design/issues/14275\n              Object.keys(allRules).some(function (ruleFieldName) {\n                var rules = allRules[ruleFieldName] || [];\n\n                // Exist if match rule\n                if (ruleFieldName === errorFieldName) {\n                  fieldName = ruleFieldName;\n                  return true;\n                }\n\n                // Skip if not match array type\n                if (rules.every(function (_ref2) {\n                  var type = _ref2.type;\n                  return type !== 'array';\n                }) || errorFieldName.indexOf(ruleFieldName + '.') !== 0) {\n                  return false;\n                }\n\n                // Exist if match the field name\n                var restPath = errorFieldName.slice(ruleFieldName.length + 1);\n                if (/^\\d+$/.test(restPath)) {\n                  fieldName = ruleFieldName;\n                  return true;\n                }\n\n                return false;\n              });\n\n              var field = (0, _get2['default'])(errorsGroup, fieldName);\n              if (typeof field !== 'object' || Array.isArray(field)) {\n                (0, _set2['default'])(errorsGroup, fieldName, { errors: [] });\n              }\n              var fieldErrors = (0, _get2['default'])(errorsGroup, fieldName.concat('.errors'));\n              fieldErrors.push(e);\n            });\n          }\n          var expired = [];\n          var nowAllFields = {};\n          Object.keys(allRules).forEach(function (name) {\n            var fieldErrors = (0, _get2['default'])(errorsGroup, name);\n            var nowField = _this7.fieldsStore.getField(name);\n            // avoid concurrency problems\n            if (!(0, _eq2['default'])(nowField.value, allValues[name])) {\n              expired.push({\n                name: name\n              });\n            } else {\n              nowField.errors = fieldErrors && fieldErrors.errors;\n              nowField.value = allValues[name];\n              nowField.validating = false;\n              nowField.dirty = false;\n              nowAllFields[name] = nowField;\n            }\n          });\n          _this7.setFields(nowAllFields);\n          if (callback) {\n            if (expired.length) {\n              expired.forEach(function (_ref3) {\n                var name = _ref3.name;\n\n                var fieldErrors = [{\n                  message: name + ' need to revalidate',\n                  field: name\n                }];\n                (0, _set2['default'])(errorsGroup, name, {\n                  expired: true,\n                  errors: fieldErrors\n                });\n              });\n            }\n\n            callback((0, _utils.isEmptyObject)(errorsGroup) ? null : errorsGroup, _this7.fieldsStore.getFieldsValue(fieldNames));\n          }\n        });\n      },\n      validateFields: function validateFields(ns, opt, cb) {\n        var _this8 = this;\n\n        var pending = new Promise(function (resolve, reject) {\n          var _getParams = (0, _utils.getParams)(ns, opt, cb),\n              names = _getParams.names,\n              options = _getParams.options;\n\n          var _getParams2 = (0, _utils.getParams)(ns, opt, cb),\n              callback = _getParams2.callback;\n\n          if (!callback || typeof callback === 'function') {\n            var oldCb = callback;\n            callback = function callback(errors, values) {\n              if (oldCb) {\n                oldCb(errors, values);\n              }\n              if (errors) {\n                reject({ errors: errors, values: values });\n              } else {\n                resolve(values);\n              }\n            };\n          }\n          var fieldNames = names ? _this8.fieldsStore.getValidFieldsFullName(names) : _this8.fieldsStore.getValidFieldsName();\n          var fields = fieldNames.filter(function (name) {\n            var fieldMeta = _this8.fieldsStore.getFieldMeta(name);\n            return (0, _utils.hasRules)(fieldMeta.validate);\n          }).map(function (name) {\n            var field = _this8.fieldsStore.getField(name);\n            field.value = _this8.fieldsStore.getFieldValue(name);\n            return field;\n          });\n          if (!fields.length) {\n            callback(null, _this8.fieldsStore.getFieldsValue(fieldNames));\n            return;\n          }\n          if (!('firstFields' in options)) {\n            options.firstFields = fieldNames.filter(function (name) {\n              var fieldMeta = _this8.fieldsStore.getFieldMeta(name);\n              return !!fieldMeta.validateFirst;\n            });\n          }\n          _this8.validateFieldsInternal(fields, {\n            fieldNames: fieldNames,\n            options: options\n          }, callback);\n        });\n        pending['catch'](function (e) {\n          // eslint-disable-next-line no-console\n          if (console.error && process.env.NODE_ENV !== 'production') {\n            // eslint-disable-next-line no-console\n            console.error(e);\n          }\n          return e;\n        });\n        return pending;\n      },\n      isSubmitting: function isSubmitting() {\n        if (process.env.NODE_ENV !== 'production' && process.env.NODE_ENV !== 'test') {\n          (0, _warning2['default'])(false, '`isSubmitting` is deprecated. ' + \"Actually, it's more convenient to handle submitting status by yourself.\");\n        }\n        return this.state.submitting;\n      },\n      submit: function submit(callback) {\n        var _this9 = this;\n\n        if (process.env.NODE_ENV !== 'production' && process.env.NODE_ENV !== 'test') {\n          (0, _warning2['default'])(false, '`submit` is deprecated. ' + \"Actually, it's more convenient to handle submitting status by yourself.\");\n        }\n        var fn = function fn() {\n          _this9.setState({\n            submitting: false\n          });\n        };\n        this.setState({\n          submitting: true\n        });\n        callback(fn);\n      },\n      render: function render() {\n        var _props = this.props,\n            wrappedComponentRef = _props.wrappedComponentRef,\n            restProps = (0, _objectWithoutProperties3['default'])(_props, ['wrappedComponentRef']); // eslint-disable-line\n\n        var formProps = (0, _defineProperty3['default'])({}, formPropName, this.getForm());\n        if (withRef) {\n          if (process.env.NODE_ENV !== 'production' && process.env.NODE_ENV !== 'test') {\n            (0, _warning2['default'])(false, '`withRef` is deprecated, please use `wrappedComponentRef` instead. ' + 'See: https://github.com/react-component/form#note-use-wrappedcomponentref-instead-of-withref-after-rc-form140');\n          }\n          formProps.ref = 'wrappedComponent';\n        } else if (wrappedComponentRef) {\n          formProps.ref = wrappedComponentRef;\n        }\n        var props = mapProps.call(this, (0, _extends6['default'])({}, formProps, restProps));\n        return _react2['default'].createElement(WrappedComponent, props);\n      }\n    });\n\n    return (0, _utils.argumentContainer)((0, _unsafeLifecyclesPolyfill2['default'])(Form), WrappedComponent);\n  };\n}\n\nexports['default'] = createBaseForm;\nmodule.exports = exports['default'];"]},"metadata":{},"sourceType":"script"}